{
    "typeName": "MongoDB::Atlas::Cluster",
    "description": "The cluster resource provides access to your cluster configurations. The resource lets you create, edit and delete clusters. The resource requires your Project ID.",
    "definitions": {
        "advancedAutoScaling": {
            "type": "object",
            "properties": {
                "DiskGB": {
                    "$ref": "#/definitions/diskGB"
                },
                "Compute": {
                    "$ref": "#/definitions/compute"
                }
            },
            "additionalProperties": false
        },
        "compute": {
            "type": "object",
            "properties": {
                "Enabled": {
                    "type": "boolean"
                },
                "ScaleDownEnabled": {
                    "type": "boolean"
                },
                "MinInstanceSize": {
                    "type": "string"
                },
                "MaxInstanceSize": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "AdvancedRegionConfig": {
            "type": "object",
            "properties": {
                "AnalyticsAutoScaling": {
                    "$ref": "#/definitions/advancedAutoScaling"
                },
                "AutoScaling": {
                    "$ref": "#/definitions/advancedAutoScaling"
                },
                "RegionName": {
                    "type": "string"
                },
                "AnalyticsSpecs": {
                        "$ref": "#/definitions/specs"
                },
                "ElectableSpecs": {
                        "$ref": "#/definitions/specs"
                },
                "Priority": {
                    "type": "integer"
                },
                "ReadOnlySpecs": {
                        "$ref": "#/definitions/specs"
                }
            },
            "additionalProperties": false
        },
        "specs": {
            "type": "object",
            "properties": {
                "DiskIOPS" : {
                    "type": "string"
                },
                "EbsVolumeType": {
                    "type": "string"
                },
                "InstanceSize": {
                    "type": "string"
                },
                "NodeCount": {
                    "type": "integer"
                }
            },
            "additionalProperties": false
        },
        "diskGB": {
            "type": "object",
            "properties": {
                "Enabled" : {
                    "type": "boolean"
                }
            },
            "additionalProperties": false
        },
        "advancedReplicationSpec": {
            "type": "object",
            "properties": {
                "ID": {
                    "type": "string"
                },
                "NumShards": {
                    "type": "integer"
                },
                "AdvancedRegionConfigs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/AdvancedRegionConfig"
                    }
                },
                "ZoneName": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "apiKeyDefinition": {
            "type": "object",
            "properties": {
                "PublicKey": {
                    "type": "string"
                },
                "PrivateKey": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "connectionStrings": {
            "type": "object",
            "properties": {
                "Standard": {
                    "type": "string"
                },
                "StandardSrv": {
                    "type": "string"
                },
                "Private": {
                    "type": "string"
                },
                "PrivateSrv": {
                    "type": "string"
                },
                "PrivateEndpoint": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/privateEndpoint"
                    }
                },
                "AwsPrivateLinkSrv": {
                    "type": "string"
                },
                "AwsPrivateLink": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "privateEndpoint": {
            "type": "object",
            "properties": {
                "ConnectionString": {
                    "type": "string"
                },
                "Endpoints": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/endpoint"
                    }
                },
                "SRVConnectionString": {
                    "type": "string"
                },
                "Type": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "endpoint": {
            "type": "object",
            "properties": {
                "EndpointID": {
                    "type": "string"
                },
                "ProviderName": {
                    "type": "string"
                },
                "Region": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "processArgs": {
            "type": "object",
            "properties": {
                "DefaultReadConcern":{
                    "type": "string"
                },
                "DefaultWriteConcern":{
                    "type": "string"
                },
                "FailIndexKeyTooLong":{
                    "type": "boolean"
                },
                "JavascriptEnabled":{
                    "type": "boolean"
                },
                "MinimumEnabledTLSProtocol":{
                    "type": "string"
                },
                "NoTableScan":{
                    "type": "boolean"
                },
                "OplogSizeMB":{
                    "type": "integer"
                },
                "SampleSizeBIConnector":{
                    "type": "integer"
                },
                "SampleRefreshIntervalBIConnector":{
                    "type": "integer"
                }
            },
            "additionalProperties": false
        }
    },
    "properties": {
        "AdvancedSettings": {
            "$ref": "#/definitions/processArgs"
        },
        "ApiKeys": {
            "$ref": "#/definitions/apiKeyDefinition"
        },
        "BackupEnabled": {
            "description": "Applicable only for M10+ clusters. Set to true to enable Atlas continuous backups for the cluster. Set to false to disable continuous backups for the cluster. Atlas deletes any stored snapshots. See the continuous backup Snapshot Schedule for more information. You cannot enable continuous backups if you have an existing cluster in the project with Cloud Provider Snapshots enabled. The default value is false.",
            "type": "boolean"
        },
        "BiConnector": {
            "type": "object",
            "properties": {
                "ReadPreference": {
                    "type": "string"
                },
                "Enabled": {
                    "type": "boolean"
                }
            },
            "additionalProperties": false
        },
        "ClusterType": {
            "description": "Type of the cluster that you want to create.",
            "type": "string"
        },
        "CreatedDate": {
            "description": "Cluster created date.",
            "type": "string"
        },
        "ConnectionStrings": {
            "description": "Set of connection strings that your applications use to connect to this cluster. Use the parameters in this object to connect your applications to this cluster. See the MongoDB [Connection String URI Format](https://docs.mongodb.com/manual/reference/connection-string/) reference for further details.",
            "$ref": "#/definitions/connectionStrings"
        },
        "DiskSizeGB": {
            "description": "Capacity, in gigabytes, of the hosts root volume. Increase this number to add capacity, up to a maximum possible value of 4096 (i.e., 4 TB). This value must be a positive integer.",
            "type": "number"
        },
        "EncryptionAtRestProvider": {
            "description": "Set the Encryption at Rest parameter.",
            "type": "string",
            "enum": [
                "AWS",
                "GCP",
                "AZURE",
                "NONE"
            ]
        },
        "ProjectId": {
            "description": "Unique identifier of the project the cluster belongs to.",
            "type": "string"
        },
        "Id": {
            "description": "Unique identifier of the cluster.",
            "type": "string"
        },
        "Labels": {
            "description": "Array containing key-value pairs that tag and categorize the cluster.",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "Key": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 255
                    },
                    "Value": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 255
                    }
                },
                "additionalProperties": false
            }
        },
        "MongoDBMajorVersion": {
            "description": "Major version of the cluster to deploy.",
            "type": "string"
        },
        "MongoDBVersion": {
            "description": "Version of the cluster to deploy.",
            "type": "string"
        },
        "Name": {
            "description": "Name of the cluster. Once the cluster is created, its name cannot be changed.",
            "type": "string"
        },
        "Paused": {
            "description": "Flag that indicates whether the cluster is paused or not.",
            "type": "boolean"
        },
        "PitEnabled": {
            "description": "Flag that indicates if the cluster uses Point-in-Time backups. If set to true, providerBackupEnabled must also be set to true.",
            "type": "boolean"
        },
        "ReplicationSpecs": {
            "description": "Configuration for cluster regions.",
            "type": "array",
            "items": {
                "$ref": "#/definitions/advancedReplicationSpec"
            }
        },
        "RootCertType": {
            "description": "Root Certificate Authority that MongoDB Cloud cluster uses. MongoDB Cloud supports Internet Security Research Group.",
            "type": "string"
        },
        "StateName": {
            "description": "Current state of the cluster.",
            "type": "string"
        },
        "VersionReleaseSystem": {
            "description": "Method by which the cluster maintains the MongoDB versions. If value is CONTINUOUS, you must not specify mongoDBMajorVersion",
            "type": "string"
        },
        "TerminationProtectionEnabled": {
            "description": "Flag that indicates whether termination protection is enabled on the cluster. If set to true, MongoDB Cloud won't delete the cluster. If set to false, MongoDB Cloud will delete the cluster.",
            "type": "boolean"
        }
    },
    "additionalProperties": false,
    "required": [
        "Name",
        "ProjectId"
    ],
    "readOnlyProperties": [
        "/properties/ConnectionStrings",
        "/properties/ConnectionStrings.Standard",
        "/properties/ConnectionStrings.StandardSrv",
        "/properties/ConnectionStrings.Private",
        "/properties/ConnectionStrings.PrivateSrv",
        "/properties/StateName",
        "/properties/MongoDBVersion",
        "/properties/CreatedDate",
        "/properties/Id"
    ],
    "primaryIdentifier": [
        "/properties/Id"
    ],
    "handlers": {
        "create": {
            "permissions": [
                "secretsmanager:DescribeSecret",
                "secretsmanager:GetSecretValue",
                "secretsmanager:PutSecretValue",
                "secretsmanager:UpdateSecretVersionStage",
                "secretsmanager:CreateSecret",
                "secretsmanager:CreateSecretInput"
            ]
        },
        "read": {
            "permissions": [
                "secretsmanager:DescribeSecret",
                "secretsmanager:GetSecretValue",
                "secretsmanager:PutSecretValue",
                "secretsmanager:UpdateSecretVersionStage",
                "secretsmanager:CreateSecret",
                "secretsmanager:CreateSecretInput"
            ]
        },
        "update": {
            "permissions": [
                "secretsmanager:DescribeSecret",
                "secretsmanager:GetSecretValue",
                "secretsmanager:PutSecretValue",
                "secretsmanager:UpdateSecretVersionStage",
                "secretsmanager:CreateSecret",
                "secretsmanager:CreateSecretInput"
            ]
        },
        "delete": {
            "permissions": [
                "secretsmanager:DescribeSecret",
                "secretsmanager:GetSecretValue",
                "secretsmanager:PutSecretValue",
                "secretsmanager:UpdateSecretVersionStage",
                "secretsmanager:CreateSecret",
                "secretsmanager:CreateSecretInput"
            ]
        }
    }
}
